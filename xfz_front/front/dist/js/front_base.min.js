function FrontBase(){}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smscaptcha=$(".sms-captcha-btn")}FrontBase.prototype.run=function(){this.listenAuehBoxHover()},FrontBase.prototype.listenAuehBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenswitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptcha(),t.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn"),s=$(".form-control");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),a.click(function(){t.hideEvent(),s.reset()})},Auth.prototype.listenswitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:0}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSmsCaptcha=function(){var n=this,e=$(".signup-group input[name='telephone']");n.smscaptcha.click(function(){var t=e.val();t||messageBox.showError("请输入手机号码！"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.smsSuccessEvent()},fail:function(t){console.log(t)}})})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smscaptcha.addClass("disabled");var n=20;t.smscaptcha.unbind("click");var e=setInterval(function(){t.smscaptcha.text(n+"s"),(n-=1)<=0&&(clearInterval(e),t.smscaptcha.removeClass("disabled"),t.smscaptcha.text("发送验证码"),t.listenSmsCaptcha())},1e3)},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),o=t.find("input[name='password']"),i=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=s.val(),n=o.val(),e=i.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){a.hideEvent(),window.location.reload()},fail:function(t){console.log(t)}})})},Auth.prototype.listenSignupEvent=function(){var m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),a=m.find("input[name='img_captcha']"),s=m.find("input[name='password1']"),o=m.find("input[name='password2']"),i=m.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),p=a.val(),u=s.val(),l=o.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:p,password1:u,password2:l,sms_captcha:h},success:function(t){window.location.reload()},fail:function(t){console.log(t),window.messageBox.showError("服务器内部错误！")}})})},$(function(){(new Auth).run()}),$(function(){(new FrontBase).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),a=((new Date).getTime()-e)/1e3;return a<60?"刚刚":60<=a&&a<3600?(minutes=parseInt(a/60),minutes+"分钟前"):3600<=a&&a<86400?(hours=parseInt(a/60/60),hours+"小时前"):86400<=a&&a<2592e3?(days=parseInt(a/60/60/24),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInNlbGYiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNtc2NhcHRjaGEiLCJwcm90b3R5cGUiLCJydW4iLCJsaXN0ZW5BdWVoQm94SG92ZXIiLCJhdXRoYm94IiwidXNlcm1vcmVib3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwibGlzdGVuU2hvd0hpZGVFdmVudCIsImxpc3RlbnN3aXRjaEV2ZW50IiwibGlzdGVuU2lnbmluRXZlbnQiLCJsaXN0ZW5JbWdDYXB0Y2hhRXZlbnQiLCJsaXN0ZW5TbXNDYXB0Y2hhIiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJzaWduaW5CdG4iLCJzaWdudXBCdG4iLCJjbG9zZUJ0biIsInV3c2VyViIsImNsaWNrIiwiY3NzIiwibGVmdCIsInJlc2V0IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJpbWdjYXB0Y2hhIiwiYXR0ciIsIk1hdGgiLCJyYW5kb20iLCJ0ZWxlcGhvbmVJbnB1dCIsInRlbGVwaG9uZSIsInZhbCIsIm1lc3NhZ2VCb3giLCJzaG93RXJyb3IiLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJzbXNTdWNjZXNzRXZlbnQiLCJmYWlsIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwic2hvd1N1Y2Nlc3MiLCJhZGRDbGFzcyIsImNvdW50IiwidW5iaW5kIiwidGltZXIiLCJzZXRJbnRlcnZhbCIsInRleHQiLCJjbGVhckludGVydmFsIiwicmVtb3ZlQ2xhc3MiLCJzaWduaW5Hcm91cCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwicG9zdCIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVsb2FkIiwic2lnbnVwR3JvdXAiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcm5hbWVJbnB1dCIsImltZ0NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ1c2VybmFtZSIsImltZ19jYXB0Y2hhIiwicGFzc3dvcmQxIiwicGFzc3dvcmQyIiwic21zX2NhcHRjaGEiLCJ0ZW1wbGF0ZSIsImRlZmF1bHRzIiwiaW1wb3J0cyIsInRpbWVTaW5jZSIsImRhdGVWYWx1ZSIsImRhdGUiLCJEYXRlIiwiZGF0ZXRzIiwiZ2V0VGltZSIsInRpbWVzdGFtcCIsIm1pbnV0ZXMiLCJob3VycyIsImRheXMiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF5IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxhQWtCVCxTQUFTQyxPQUNMLElBQUlDLEVBQU9DLEtBQ1hELEVBQUtFLFlBQWNDLEVBQUUsaUJBQ3JCSCxFQUFLSSxjQUFjRCxFQUFFLG1CQUNyQkgsRUFBS0ssV0FBWUYsRUFBRSxvQkFsQnZCTCxVQUFVUSxVQUFVQyxJQUFLLFdBQ1hOLEtBQ0xPLHNCQUVUVixVQUFVUSxVQUFVRSxtQkFBbUIsV0FDbkMsSUFBSUMsRUFBVU4sRUFBRSxhQUNaTyxFQUFhUCxFQUFFLGtCQUNuQk0sRUFBUUUsTUFBTSxXQUNWRCxFQUFZRSxRQUNkLFdBQ0FGLEVBQVlHLFVBVWxCZCxLQUFLTyxVQUFVQyxJQUFNLFdBQ2pCLElBQUlQLEVBQU1DLEtBQ1ZELEVBQUtjLHNCQUNMZCxFQUFLZSxvQkFDTGYsRUFBS2dCLG9CQUNMaEIsRUFBS2lCLHdCQUNMakIsRUFBS2tCLG1CQUNMbEIsRUFBS21CLHFCQUdUcEIsS0FBS08sVUFBVWMsVUFBWSxXQUNabkIsS0FDTkMsWUFBWVUsUUFHckJiLEtBQUtPLFVBQVVlLFVBQVksV0FDWnBCLEtBQ05DLFlBQVlXLFFBR3JCZCxLQUFLTyxVQUFVUSxvQkFBc0IsV0FDakMsSUFBSWQsRUFBTUMsS0FDTnFCLEVB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Q29udGVudCI6WyJmdW5jdGlvbiBGcm9udEJhc2UoKSB7XHJcblxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLnJ1bj0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID10aGlzO1xyXG4gICAgc2VsZi5saXN0ZW5BdWVoQm94SG92ZXIoKTtcclxufTtcclxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdWVoQm94SG92ZXI9ZnVuY3Rpb24oKXtcclxuICAgIHZhciBhdXRoYm94ID0gJCgnLmF1dGgtYm94Jyk7XHJcbiAgICB2YXIgdXNlcm1vcmVib3g9ICQoJy51c2VyLW1vcmUtYm94Jyk7XHJcbiAgICBhdXRoYm94LmhvdmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VybW9yZWJveC5zaG93KCk7XHJcbiAgICB9LGZ1bmN0aW9uICgpIHtcclxuICAgICAgdXNlcm1vcmVib3guaGlkZSgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBBdXRoKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlciA9ICQoJy5tYXNrLXdyYXBwZXInKTtcclxuICAgIHNlbGYuc2Nyb2xsV3JhcHBlcj0kKCcuc2Nyb2xsLXdyYXBwZXInKTtcclxuICAgIHNlbGYuc21zY2FwdGNoYT0gJCgnLnNtcy1jYXB0Y2hhLWJ0bicpO1xyXG59XHJcbkF1dGgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID10aGlzO1xyXG4gICAgc2VsZi5saXN0ZW5TaG93SGlkZUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlbnN3aXRjaEV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ25pbkV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlbkltZ0NhcHRjaGFFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhKCk7XHJcbiAgICBzZWxmLmxpc3RlblNpZ251cEV2ZW50KCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zaG93RXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5zaG93KCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5oaWRlKCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaG93SGlkZUV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID10aGlzO1xyXG4gICAgdmFyIHNpZ25pbkJ0biA9JCgnLnNpZ25pbi1idG4nKTtcclxuICAgIHZhciBzaWdudXBCdG4gPSQoJy5zaWdudXAtYnRuJyk7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSQoJy5jbG9zZS1idG4nKTtcclxuICAgIHZhciB1d3NlclY9JCgnLmZvcm0tY29udHJvbCcpO1xyXG5cclxuICAgIHNpZ25pbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6MH0pO1xyXG4gICAgfSk7XHJcbiAgICBzaWdudXBCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7J2xlZnQnOi00MDB9KTtcclxuICAgIH0pO1xyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgIHV3c2VyVi5yZXNldCgpO1xyXG4gICAgICAgLy8gdXdzZXJWLnNldChudWxsKTtcclxuICAgICAgIC8vICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBhc3N3b3JkXCIpLnJlc2V0KClcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuc3dpdGNoRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGY9dGhpcztcclxuICAgIHZhciBzd2l0Y2hlcj0kKCcuc3dpdGNoJyk7XHJcbiAgICBzd2l0Y2hlci5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRMZWZ0ID0gc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbiAgICAgICAgY3VycmVudExlZnQ9cGFyc2VJbnQoY3VycmVudExlZnQpO1xyXG4gICAgICAgIGlmIChjdXJyZW50TGVmdDwwKXtcclxuICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5hbmltYXRlKHtcImxlZnRcIjowfSk7XHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6XCItNDAwcHhcIn0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuSW1nQ2FwdGNoYUV2ZW50PWZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgaW1nY2FwdGNoYSA9JCgnLmltZy1jYXB0Y2hhJyk7XHJcbiAgICBpbWdjYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbWdjYXB0Y2hhLmF0dHIoXCJzcmNcIixcIi9hY2NvdW50L2ltZ19jYXB0Y2hhL1wiK1wiP3JhbmRvbT1cIitNYXRoLnJhbmRvbSgpKVxyXG4gICAgICAgIC8vIGltZ2NhcHRjaGEuYXR0cihcInNyY1wiLFwiL2FjY291bnQvaW1nX2NhcHRjaGEvXCIrXCI/cmFuZG9tPVwiK01hdGgucmFuZG9tKCkpXHJcbiAgICB9KVxyXG59O1xyXG5cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0NhcHRjaGE9ZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID10aGlzO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0PSQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgc2VsZi5zbXNjYXB0Y2hhLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgIHZhciB0ZWxlcGhvbmU9dGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgaWYoIXRlbGVwaG9uZSl7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VCb3guc2hvd0Vycm9yKCfor7fovpPlhaXmiYvmnLrlj7fnoIHvvIEnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJzonL2FjY291bnQvc21zX2NhcHRjaGEvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOntcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOnRlbGVwaG9uZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ109PTIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOmZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzRXZlbnQ9ZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICBtZXNzYWdlQm94LnNob3dTdWNjZXNzKCfnn63kv6Hpqozor4HnoIHlj5HpgIHmiJDlip/vvIEnKTtcclxuICAgIHNlbGYuc21zY2FwdGNoYS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgIHZhciBjb3VudD0gMjA7XHJcbiAgICBzZWxmLnNtc2NhcHRjaGEudW5iaW5kKCdjbGljaycpO1xyXG4gICAgdmFyIHRpbWVyPXNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNtc2NhcHRjaGEudGV4dChjb3VudCsncycpO1xyXG4gICAgICAgIGNvdW50LT0xO1xyXG4gICAgICAgIGlmKGNvdW50PD0wKXtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHNlbGYuc21zY2FwdGNoYS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNjYXB0Y2hhLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGEoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIH0sMTAwMCk7XHJcblxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbmluRXZlbnQ9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAvLyB2YXIgY2xvc2VCdG4gPSQoJy5jbG9zZS1idG4nKTtcclxuICAgIHZhciBzaWduaW5Hcm91cCA9ICQoJy5zaWduaW4tZ3JvdXAnKTtcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgIHZhciBwYXNzd29yZElucHV0PSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcbiAgICB2YXIgc3VibWl0QnRuPXNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuXHJcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmU9dGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkID0gcGFzc3dvcmRJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcmVtZW1iZXI9IHJlbWVtYmVySW5wdXQucHJvcChcImNoZWNrZWRcIik7XHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOicvYWNjb3VudC9sb2dpbi8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6e1xyXG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6dGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzpwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6cmVtZW1iZXI/MTowXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdmYWlsJzpmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzaWdudXBHcm91cCA9ICQoJy5zaWdudXAtZ3JvdXAnKTtcclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWdudXBHcm91cC5maW5kKCcuc3VibWl0LWJ0bicpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgICAgIHZhciB1c2VybmFtZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIik7XHJcbiAgICAgICAgdmFyIGltZ0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQySW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIik7XHJcbiAgICAgICAgdmFyIHNtc0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpO1xyXG5cclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gdXNlcm5hbWVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgc21zX2NhcHRjaGEgPSBzbXNDYXB0Y2hhSW5wdXQudmFsKCk7XHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvcmVnaXN0ZXIvJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxyXG4gICAgICAgICAgICAgICAgJ3VzZXJuYW1lJzogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZDEnOiBwYXNzd29yZDEsXHJcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQyJzogcGFzc3dvcmQyLFxyXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdmYWlsJzpmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dFcnJvcign5pyN5Yqh5Zmo5YaF6YOo6ZSZ6K+v77yBJylcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhdXRoID0gbmV3IEF1dGgoKTtcclxuICAgIGF1dGgucnVuKClcclxufSk7XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGZyb250YmFzZSA9IG5ldyBGcm9udEJhc2UoKTtcclxuICAgZnJvbnRiYXNlLnJ1bigpO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgaWYod2luZG93LnRlbXBsYXRlKXtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xyXG4gICAgICAgICAgICB2YXIgZGF0ZXRzID0gZGF0ZS5nZXRUaW1lKCk7IC8vIOW+l+WIsOeahOaYr+avq+enkueahFxyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOyAvL+W+l+WIsOeahOaYr+W9k+WJjeaXtumXtOeahOaXtumXtOaIs1xyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKS8xMDAwOyAvLyDpmaTku6UxMDAw77yM5b6X5Yiw55qE5piv56eSXHJcbiAgICAgICAgICAgIGlmKHRpbWVzdGFtcCA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+WImuWImic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAgJiYgdGltZXN0YW1wIDwgNjAqNjApIHtcclxuICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcysn5YiG6ZKf5YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCkge1xyXG4gICAgICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBob3Vycysn5bCP5pe25YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCozMCkge1xyXG4gICAgICAgICAgICAgICAgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyKycvJyttb250aCsnLycrZGF5K1wiIFwiK2hvdXIrXCI6XCIrbWludXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTsiXX0=
